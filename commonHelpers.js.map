{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { loadMoreBtn } from '../main.js';\n\n// === EXPORT\n\nexport function renderGallery(images, gallery) {\n  const markup = createMarkup(images);\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nexport function generateToastError(error) {\n  // expected errors\n  if (error.toString() === '400')\n    error = 'Tell support there is a parameter error.'; //to test comment the \"key\" URL parameter\n  if (error.toString() === '404')\n    error = 'Tell support there is an endpoint error.'; // to test change const END_POINT = '/api/dapi';\n  if (error.toString() === '500') error = 'Try again later.';\n  if (error.toString() === 'missing_keyword') error = 'Enter the keyword.';\n  if (error.toString() === 'no_images_found')\n    error =\n      'Sorry, there are no images matching your search query. Please try again!';\n  iziToast.show({\n    title: 'Oops!',\n    message: `${error}`,\n    position: 'bottomLeft',\n    color: 'red',\n    displayMode: 'replace',\n  });\n}\n\nexport function generateToastInfo(reason) {\n  if (reason === 'no_more_results')\n    reason = 'We are sorry, but you have reached the end of search results.';\n  iziToast.show({\n    title: 'â“˜',\n    message: `${reason}`,\n    position: 'bottomLeft',\n    color: 'blue',\n    displayMode: 'replace',\n  });\n}\n\nexport function showLoadMoreBtn(showBoolean) {\n  showBoolean\n    ? loadMoreBtn.classList.remove('visually-hidden')\n    : loadMoreBtn.classList.add('visually-hidden');\n}\n\n// === FUNCTIONS\n\nfunction createMarkup(imagesArray) {\n  if (imagesArray.length === 0) {\n    return '';\n  }\n\n  let imageMarkupString = '';\n\n  imagesArray.forEach(image => {\n    imageMarkupString += `<li><a href=\"${\n      image.largeImageURL\n    }\"><img src=\"${image.webformatURL.replace('_640', '_340')}\" alt=\"${\n      image.tags\n    }\"/></a>${createImageStatsMarkup(image)}\n</li>`;\n  });\n  return imageMarkupString;\n}\n\nfunction createImageStatsMarkup(image) {\n  return `<div class=\"stats-box\"><p>Likes<br><span>${image.likes}</span></p><p>Views<br><span>${image.views}</span></p><p>Comments<br><span>${image.comments}</span></p><p>Downloads<br><span>${image.downloads}</span></p></div>`;\n}\n","import axios from 'axios';\nimport {\n  showLoadMoreBtn,\n  generateToastError,\n  generateToastInfo,\n} from './render-functions';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst userKey = '43979459-cb9029671f39809d08984a919';\nconst perPage = 15;\nlet resultsLimit;\nlet requestedPage = 1;\n\n// === EXPORT\n\nexport async function getPictures(keyWord) {\n  const params = {\n    params: {\n      q: keyWord,\n      key: userKey,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: perPage,\n      page: requestedPage,\n    },\n  };\n\n  try {\n    const result = await axios.get('', params);\n    const fetchedImages = result.data;\n    if (fetchedImages.totalHits === 0) {\n      generateToastError('no_images_found');\n      return;\n    }\n\n    requestedPage += 1;\n    resultsLimit = Math.ceil(fetchedImages.totalHits / perPage);\n    resultsLimit >= requestedPage\n      ? showLoadMoreBtn(true)\n      : generateToastInfo('no_more_results');\n\n    return fetchedImages.hits;\n  } catch (error) {\n    const problem = error?.response?.status ? error.response.status : error;\n    generateToastError(problem);\n  }\n}\n\nexport function resetRequestedPage() {\n  requestedPage = 1;\n  resultsLimit = 15;\n}\n","import simpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { getPictures, resetRequestedPage } from './js/pixabay-api.js';\nimport {\n  generateToastError,\n  renderGallery,\n  showLoadMoreBtn,\n} from './js/render-functions.js';\n\n// === REFS ===\nexport const loadMoreBtn = document.querySelector('.load-more-js');\nexport const gallery = document.querySelector('.gallery');\n\nconst searchForm = document.querySelector('.search-wrapper');\nconst imageLinkSelector = '.gallery a';\nconst loader = document.querySelector('.loader');\nconst noResultsPlaceholder = document.querySelector('.nothing-fetched');\n\nconst lightbox = new simpleLightbox(imageLinkSelector, {\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nlet keyWord = '';\n\n// === LOGIC ===\n\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n\n  keyWord = event.target.elements.searchbox.value.trim();\n  if (keyWord === '') {\n    generateToastError('missing_keyword');\n    return;\n  }\n\n  gallery.innerHTML = '';\n  resetRequestedPage();\n  await updateGallery();\n});\n\nloadMoreBtn.addEventListener('click', async event => {\n  await updateGallery();\n  scrollItems(2);\n});\n\n// === FUNCTIONS ===\n\nasync function updateGallery() {\n  showNotFoundState(false);\n  loader.classList.remove('visually-hidden');\n\n  showLoadMoreBtn(false);\n\n  const images = await getPictures(keyWord);\n  loader.classList.add('visually-hidden');\n  if (!Array.isArray(images)) return;\n\n  renderGallery(images, gallery);\n  lightbox.refresh();\n\n  if (!gallery.hasChildNodes()) showNotFoundState(true);\n}\n\nfunction showNotFoundState(showBoolean) {\n  showBoolean\n    ? noResultsPlaceholder.classList.remove('visually-hidden')\n    : noResultsPlaceholder.classList.add('visually-hidden');\n}\n\nfunction scrollItems(number) {\n  const galleryItem = gallery.querySelector('li');\n  const rect = galleryItem.getBoundingClientRect();\n  window.scrollBy({\n    top: number * rect.height,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n"],"names":["renderGallery","images","gallery","markup","createMarkup","generateToastError","error","iziToast","generateToastInfo","reason","showLoadMoreBtn","showBoolean","loadMoreBtn","imagesArray","imageMarkupString","image","createImageStatsMarkup","axios","userKey","perPage","resultsLimit","requestedPage","getPictures","keyWord","params","fetchedImages","problem","_a","resetRequestedPage","searchForm","imageLinkSelector","loader","noResultsPlaceholder","lightbox","simpleLightbox","event","updateGallery","scrollItems","showNotFoundState","number","rect"],"mappings":"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"}